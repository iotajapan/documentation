# ZMQ processor

**When you subscribe to ZMQ events, you receive near real-time Tangle data from a node. To process this data, you can use a stream processing framework such as the open-source [Apache Flink](https://flink.apache.org/). In this guide, you use the [Flink Tangle source library](https://github.com/Citrullin/flink-tangle-source) to display the top 10 most used addresses from the past hour.**

This library uses the [ZeroMQMessageParser](https://github.com/Citrullin/tangle-streaming/blob/master/src/main/scala/org/iota/tangle/stream/ZeroMQMessageParser.scala) from the [Tangle streaming library](https://github.com/Citrullin/tangle-streaming) to parse the raw event messages into class instances.
All ZMQ event messages are wrapped in classes that are generated by [protobuf schema files](https://github.com/Citrullin/tangle-streaming/tree/master/src/main/protobuf). All protobuf messages and attributes are also available in Flink.

Because this library uses the ZMQ API, all [ZMQ events](root://node-software/0.1/iri/references/zmq-events.md) are available for processing.

:::info:
The Tangle streaming libraries in this guide are not recommended for production environments.
Feel free to contribute to the libraries, so that they eventually become production ready.
:::

## Prerequisites

To complete this guide, you need the following:

- **Operating system:** Linux, MacOS, BSD or Windows
- **RAM:** 2GB
- **Storage:** 10GB free space

## Display the top 10 most used addresses

1. [Install Java](http://openjdk.java.net/install/). Because Scala uses the Java virtual machine, you must install Java 8 or higher.

2. [Install sbt](https://www.scala-sbt.org/1.x/docs/Setup.html)

3. Clone the libraries

  ```bash
  git clone https://github.com/Citrullin/tangle-streaming.git
  git clone https://github.com/Citrullin/flink-tangle-source
  ```

4. Change into the `tangle-streaming` directory and initialize the REPL (Read-Evaluate-Print Loop)

  ```bash
  cd tangle-streaming
  sbt
  ```

5. In the REPL, build the library

  ```bash
  compile
  publishLocal
  ```

  :::info:
  Press **Ctrl** + **C** to terminate the REPL.
  :::

6. Change into the `flink-tangle-source` directory and initialize the REPL

  ```bash
  cd ../flink-tangle-source
  sbt
  ```

7. In the REPL, build the library

  ```bash
  compile
  publishLocal
  ```

8. Clone the example repository

  ```bash
  git clone https://github.com/iota-community/flink-tangle-examples.git
  ```

9. Change into the `flink-tangle-examples` directory and run the project

  ```bash
  cd flink-tangle-examples
  sbt run
  ```

10. Enter the number 2 to run the project

- [1] org.iota.tangle.flink.examples.BundleAggregation
- [2] org.iota.tangle.flink.examples.MostUsedAddresses

## Next steps

Now you can fork the [repository](https://github.com/iota-community/flink-tangle-examples) and build your own ZMQ streaming projects.

Or, you can run the BundleAggregator project, which uses the node's ZMQ stream to return a stream of bundles rather than a stream of individual transactions. 

If you want, you can edit the `src/main/resources/application.conf` file so that the code connects to a different node's ZMQ stream.

:::info:
If you run your own node, you have to [enable the ZMQ configuration parameter](root://node-software/0.1/iri/references/iri-configuration-options.md).
:::

:::info:
[Tanglebeat provides a list of public nodes that have ZMQ enabled.](http://tanglebeat.com/page/internals).
:::